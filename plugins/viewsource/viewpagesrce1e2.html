                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=23527865 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 09:55:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpagee1e2.html?pageId=23527865" />
        <link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch934e.css?media=print" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 8]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+8" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1f2a9c4c7f2593422cc9b02d1a652a22/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/26ac2724af3c6ece1051365650d982fa/_/download/contextbatch/css/editor-content/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-hig/com.atlassian.confluence.plugins.confluence-highlight-ac" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/51/_/styles/colorsb538.css?spaceKey=EZP" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/51/_/styles/customb538.css?spaceKey=EZP" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <table class="wysiwyg-macro" data-macro-name="note" data-macro-parameters="title=eZ Publish Platform 5.3 and higher" style="background-image: url(../servlet/confluence/placeholder/macro-headingb309.png?definition=e25vdGU6dGl0bGU9ZVogUHVibGlzaCBQbGF0Zm9ybSA1LjMgYW5kIGhpZ2hlcn0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>This page only applies to eZ Publish Platform 5.3 and higher, for earlier versions of the Enterprise version of eZ Publish consult S<em>ervice Portal user guide</em> available for download at <a href="http://support.ez.no/">support.ez.no</a>. This page is also generic about using Composer, for instructions specific to a release, see <a class="confluence-link" href="../../display/EZP/eZ%2bPublish%2bPlatform%2bReleases.html" data-linked-resource-id="12781017" data-linked-resource-type="page" data-linked-resource-default-alias="eZ Publish Platform Releases" data-base-url="../../index.html">release notes</a>.</p></td></tr></table><p>Keeping your system up-to-date is important, to make sure your it is running optimally and securely. The update mechanism in eZ Publish Platform is using the <em>de facto</em> standard PHP packaging system called <a href="https://getcomposer.org/">Composer</a>. <br />This makes it easy to adapt package installs and updates to your workflow, allowing you to test new/updated packages in a development environment, put the changes in your version control system (git, Subversion, Mercurial, etc.), pull in those changes on a staging environment and, when approved, put it in production.</p><p> </p><p> </p><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc"></p><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro2d05.png?definition=e2V4Y2VycHQtaW5jbHVkZTpnbG9zc2FyeTpDb21wb3NlcnxxdWlja2ZpbmQtcGFnZT1Db21wb3NlcnxwYWdlTmFtZT1Db21wb3NlcnxwYWdlSWQ9MjM1Mjg1NTJ8d2lkdGg9NTAlfHVybD1yZXN0L2dhZGdldHMvMS4wL2cvY29tLmF0bGFzc2lhbi5jb25mbHVlbmNlLnBsdWdpbnMuZ2FkZ2V0czpjb25mbHVlbmNlLXBhZ2UtZ2FkZ2V0L2dhZGdldHMvY29uZmx1ZW5jZS1wYWdlLWdhZGdldC54bWx8YXV0aG9yPWVaIFN5c3RlbXN8cXVpY2tmaW5kLXNwYWNlPXxpc0NvbmZpZ3VyZWQ9dHJ1ZXxzaG93TGluaz10cnVlfHNwYWNlTmFtZT18c3BhY2VLZXk9Z2xvc3Nhcnl8cmVmcmVzaD1mYWxzZXxpc0VkaXRhYmxlPWZhbHNlfHByZWZlcmVuY2VzPXNwYWNlTmFtZT1HbG9zc2FyeSZzcGFjZUtleT1nbG9zc2FyeSZxdWlja2ZpbmQtc3BhY2U9R2xvc3NhcnkmcGFnZUlkPTIzNTI4NTUyJnBhZ2VOYW1lPUNvbXBvc2VyJnF1aWNrZmluZC1wYWdlPUNvbXBvc2VyJmlzQ29uZmlndXJlZD10cnVlJnJlZnJlc2g9ZmFsc2Umc2hvd0xpbms9ZmFsc2UmaXNFZGl0YWJsZT1mYWxzZX0&amp;locale=en_GB&amp;version=2" data-macro-name="excerpt-include" data-macro-parameters="author=eZ Systems|isConfigured=true|isEditable=false|pageId=23528552|pageName=Composer|preferences=spaceName\=Glossary&amp;spaceKey\=glossary&amp;quickfind-space\=Glossary&amp;pageId\=23528552&amp;pageName\=Composer&amp;quickfind-page\=Composer&amp;isConfigured\=true&amp;refresh\=false&amp;showLink\=false&amp;isEditable\=false|quickfind-page=Composer|quickfind-space=|refresh=false|showLink=true|spaceKey=glossary|spaceName=|url=rest/gadgets/1.0/g/com.atlassian.confluence.plugins.gadgets:confluence-page-gadget/gadgets/confluence-page-gadget.xml|width=50%" data-macro-default-parameter="glossary:Composer"></p><h1>Installing Composer</h1><p style="text-align: right;"> </p><p>This step is only needed once per machine (per project by default, but installing globally on the machine is also possible. For alternatives see: <a href="https://getcomposer.org/download/">https://getcomposer.org/download/</a>).<br />Composer is a command line tool, so the main way to install it is via command-line, example:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=bash|title=composer download in current folder:" style="background-image: url(../servlet/confluence/placeholder/macro-headinge313.png?definition=e2NvZGU6dGl0bGU9Y29tcG9zZXIgZG93bmxvYWQgaW4gY3VycmVudCBmb2xkZXI6fGxhbmd1YWdlPWJhc2h9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -r "readfile('https://getcomposer.org/installer');" | php</pre></td></tr></table><p>NB: this should be executed in the root directory of your eZ Publish installation.</p><h1>Prerequisite to using composer</h1><h3><span style="font-size: 16.0px;line-height: 1.5625;">Setting up </span><span style="font-size: 14.0px;line-height: 1.4285715;">Authentication tokens </span><span style="line-height: 1.5625;">for access to commercial updates</span></h3><p>Out of the box composer uses a packaging repository called <a href="https://packagist.org/">packagist.org</a> to find all open source packages and their updates. Additional commercial packages are available for the eZ Publish Platform at <a href="https://updates.ez.no/bul/">updates.ez.no/bul/</a> <em>(which is password protected, you will need to set up authentication tokens as described below to get access)</em>.</p><p>To get access to these updates log in to your service portal on <a href="https://support.ez.no/">support.ez.no</a>. If your project is configured for eZ Publish Platform 5.3 or higher, you will see the following on the <em>&quot;Maintenance and Support agreement details&quot;</em> screen:</p><p><img class="confluence-embedded-image" height="164" width="946" confluence-query-params="effects=drop-shadow" src="../../download/attachments/23527865/Screen%20Shot%202014-06-02%20at%2012.54.06%2084c7.png?version=1&amp;modificationDate=1401708852000&amp;api=v2&amp;effects=drop-shadow" data-image-src="/download/attachments/23527865/Screen%20Shot%202014-06-02%20at%2012.54.06%20.png?version=1&amp;modificationDate=1401708852000&amp;api=v2&amp;effects=drop-shadow" data-linked-resource-id="23887880" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2014-06-02 at 12.54.06 .png" data-base-url="https://doc.ez.no" data-linked-resource-container-id="23527865" title="eZ Publish Platform 5.x > Using Composer > Screen Shot 2014-06-02 at 12.54.06 .png" data-location="eZ Publish Platform 5.x > Using Composer > Screen Shot 2014-06-02 at 12.54.06 .png"></p><ol><li>Click &quot;Create token&quot;</li><li>Fill in a label describing the use of the token. This will allow you to revoke access later<br /><ul><li>Example, if you need to provide access to updates to a third party a good to example would be &quot;53-upgrade-project-by-partner-x&quot;</li></ul></li><li>Copy the password, <strong>you will not get access to this again</strong>!</li></ol><p>When running composer to get updates, you will be asked for a Username and Password. Use:</p><p>as Username: your <span>Installation key found higher up on the <em>&quot;Maintenance and Support agreement details&quot;</em> page in the support portal</span></p><p><span>as Password: the token password you retrieved in step 3.</span> </p><h4>Optional: Save authentication information in auth.json to avoid repeatedly typing it</h4><p>To avoid having to always fill your credentials, add an <code>auth.json</code> file at your project root, next <code>composer.json</code>, or in your <a href="https://getcomposer.org/doc/03-cli.md#composer-home">COMPOSER_HOME</a> directory for machine-wide use. The file looks like the following:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=js|title=auth.json" style="background-image: url(../servlet/confluence/placeholder/macro-heading4952.png?definition=e2NvZGU6dGl0bGU9YXV0aC5qc29ufGxhbmd1YWdlPWpzfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{
    "config": {
        "basic-auth": {
            "updates.ez.no": {
                "username": "&lt;installation-key>",
                "password": "&lt;token password>"
            }
        }
    }
}</pre></td></tr></table><p>The fine print: bundled with eZ Publish Platform is <a href="https://github.com/bitExpert/composer-authstore-plugin">a Composer extension</a> which makes it possible to store authentication information in that file.</p><h1>Using composer</h1><h3># Running composer update and version changes</h3><p>Updating eZ Publish Platform via composer is nothing different then <a href="https://getcomposer.org/doc/03-cli.md#update">updating other projects via composer</a>, but for illustration here is how you update your project locally:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=bash|title=composer update" style="background-image: url(../servlet/confluence/placeholder/macro-heading9e49.png?definition=e2NvZGU6dGl0bGU9Y29tcG9zZXIgdXBkYXRlfGxhbmd1YWdlPWJhc2h9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar update --no-dev --prefer-dist</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Tip" style="background-image: url(../servlet/confluence/placeholder/macro-heading10a5.png?definition=e2luZm86dGl0bGU9VGlwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body">Tip: This will load in all updated packages, from eZ as well as third party libraries both used by eZ and others you may have added. So when updating like this it is recommended to take note of what was updated so you have an idea of what you should test before putting the updates into production.</td></tr></table><p> </p><p>When this has completed, make sure to version (assuming you use a version control system) changes done to <code>composer.lock</code> file. This is the file that contains <strong>all details of which versions are currently used</strong> and makes sure the same version is used among all developers, staging and eventually production when current changes are approved for production (assuming you have a workflow for this).</p><p> </p><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Tip" style="background-image: url(../servlet/confluence/placeholder/macro-heading10a5.png?definition=e2luZm86dGl0bGU9VGlwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body">Tip2: In large development teams make sure people don't blindly update and install third party components, this might easily lead to version conflicts on composer.lock file and can be tiring to fix-up if happening frequently. A workflow involving composer install and unit test execution on proposed changes can help avoid most of this, like available via Github/Bitbucket Pull Request workflow.</td></tr></table><p> </p><h3># Installing versioned updates on other development machines and/or staging</h3><p>Installing eZ Publish Platform packages via Composer is nothing different then <a href="https://getcomposer.org/doc/03-cli.md#install">installing vanilla packages via Composer</a>, and for illustration here is how you install versioned updates:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=composer install (package installation)" style="background-image: url(../servlet/confluence/placeholder/macro-heading5efd.png?definition=e2NvZGU6dGl0bGU9Y29tcG9zZXIgaW5zdGFsbCAocGFja2FnZSBpbnN0YWxsYXRpb24pfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar install --no-dev --prefer-dist</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Tip" style="background-image: url(../servlet/confluence/placeholder/macro-heading10a5.png?definition=e2luZm86dGl0bGU9VGlwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body">Tip: Here the importance of composer.lock comes in as this command will tell composer to install packages in exactly same version as defined in composer.lock. If you don't keep track of composer.lock it will instead just install always latests version of a package, hence not allow you to stage updates before moving it towards production.</td></tr></table><h3># Installing eZ packages via composer</h3><p>Also requiring eZ Publish Platform packages via composer is nothing different then <a href="https://getcomposer.org/doc/03-cli.md#require">requiring vanilla packages via Composer</a>, and for illustration here is how you install a eZ package:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=composer install (package installation)" style="background-image: url(../servlet/confluence/placeholder/macro-heading5efd.png?definition=e2NvZGU6dGl0bGU9Y29tcG9zZXIgaW5zdGFsbCAocGFja2FnZSBpbnN0YWxsYXRpb24pfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar require --prefer-dist ezsystems/ezfind-ls:5.3.*</pre></td></tr></table><h3># Notes on using Composer with Legacy</h3><p>(eZ Publish) Legacy by design places all important customizable folders within it's own structure. This is not ideal with Composer, as installation and updates might cause them to become as provided by packages again.<br />To make sure you are safe from this, and to allow you to version these custom folders independently,<strong> it is recommended that you use symlinks</strong> and keep your custom settings, extensions and design <strong>outside of the ezpublish_legacy folder</strong>. To not have to manually deal with these symlinks it is recommended to use Composer <code>post-install-cmd</code> and <code>post-update-command</code> script commands to make this automated.</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Affected extensions" style="background-image: url(../servlet/confluence/placeholder/macro-heading5030.png?definition=e2luZm86dGl0bGU9QWZmZWN0ZWQgZXh0ZW5zaW9uc30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>All extensions not provided via composer is affected by this, currently the following extensions from eZ is not provided via composer and needs to be setup like proposed in this section: <em>eznetwork, ezrecommendation </em>and<em> ezma</em>.</p></td></tr></table><p> </p><p>Below is a illustration on how this can be setup, see <a href="https://getcomposer.org/doc/articles/scripts.md">Composer documentation for further info</a>.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=Example on composer.json symlinking" style="background-image: url(../servlet/confluence/placeholder/macro-heading4017.png?definition=e2NvZGU6dGl0bGU9RXhhbXBsZSBvbiBjb21wb3Nlci5qc29uIHN5bWxpbmtpbmd9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{
    "scripts": {
        "post-install-cmd": [
            "MyVendor\\MyClass::symlinkLegacyFolders"
        ],
        "post-update-cmd": [
            "MyVendor\\MyClass::symlinkLegacyFolders"
        ]
    }
}</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="note" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body">This functionality is desirable to have out of the box in the future, so community contributions on this topic is welcome to find a good standard convention and script to handle it.</td></tr></table>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=23527865 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 09:55:08 GMT -->
</html>
