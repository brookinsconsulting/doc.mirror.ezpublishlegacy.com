                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=8323282 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 09:42:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage65fa.html?pageId=8323282" />
        <link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch934e.css?media=print" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 8]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+8" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1f2a9c4c7f2593422cc9b02d1a652a22/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/26ac2724af3c6ece1051365650d982fa/_/download/contextbatch/css/editor-content/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-hig/com.atlassian.confluence.plugins.confluence-highlight-ac" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/51/_/styles/colorsb538.css?spaceKey=EZP" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/51/_/styles/customb538.css?spaceKey=EZP" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p>Sessions are handled by the Symfony2 framework, specifically API and underlying session handlers provided by HTTP Fundation component[1][2], this is further enhanced in eZ Publish with support for siteaccess aware <a class="confluence-link" href="../../display/EZP/Session%2bconfiguration.html" data-linked-resource-id="19891597" data-linked-resource-type="page" data-linked-resource-default-alias="Session configuration" data-base-url="../../index.html">session cookie settings</a>.</p><h1>Session handlers</h1><p>In Symfony, session handler is configured using <code>framework.session.handler_id.</code> By default Symfony's <em style="line-height: 1.4285715;">NativeFileSessionHandler</em>[3] is configured in eZ Publish, but Symfony can also be configured to use <span style="line-height: 1.4285715;">custom handlers[2]</span>, or just fallback to what is configured in PHP by setting it to null (<code>~</code>).</p><h3>Single server setup</h3><p>For single server, default settings should be preferred. As implied above they setup PHP's builtin &quot;files&quot; session save handler, and specifically configures it to use <code>session.save_path</code> set to <code>ezpublish/sessions</code> by default <code>(ezpublish/cache/&lt;env&gt;</code> before 5.3).</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Session Garbage collection on Debian &amp; Ubuntu" style="background-image: url(../servlet/confluence/placeholder/macro-heading89ca.png?definition=e2luZm86dGl0bGU9U2Vzc2lvbiBHYXJiYWdlIGNvbGxlY3Rpb24gb24gRGViaWFuICYgVWJ1bnR1fQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Debian based distros <a href="https://bugs.launchpad.net/ubuntu/+source/php5/+bug/316441">disables</a> <a href="http://php.net/manual/en/session.configuration.php#ini.session.gc-probability"><span>session.</span><span>gc_probability</span></a><span> by default an uses cronjob instead to clear sessions files. As we use custom save_path for sessions that would normally be a problem, however default Symfony settings makes sure to re enable this in </span><code>framework.session.gc_probability</code> so it should work by garbage collecting sessions for each 100th request out of the box.</p></td></tr></table><h3>Cluster setup</h3><p>For Cluster setup we need to configure Sessions to use a backend that is shared between web servers, and supports locking. Only options out of the box supporting this is PHP memcached session save handler provided by php-memcache<u>d</u> extension, and Symfony session handler for PDO (database).</p><h4>Storing sessions in Memcached using php-memcached</h4><p>For setting up eZ Publish using this memcached you'll need to configure the session save handler settings in php.ini as documented <a href="http://php.net/manual/en/memcached.sessions.php">here</a>, optionally tweak <a href="http://fr2.php.net/manual/en/memcached.configuration.php">php-memcached session settings</a>, and lastly disable Symfony session handler like:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=powershell" style="background-image: url(../servlet/confluence/placeholder/macro-heading59dd.png?definition=e2NvZGU6bGFuZ3VhZ2U9cG93ZXJzaGVsbH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>framework:
    session:
        # handler_id set to null like here will use default session handler from php.ini
        handler_id: ~</pre></td></tr></table><p> </p><h4>Alternative storing sessions in database using PDO</h4><p>While not currently our recommendation from performance perspective, for setups where where Database is preferred for storing Sessions, you may use Symfony's PdoSessionHandler.<br />Below is an configuration example for eZ Publish, but please refer to <a href="http://symfony.com/doc/current/cookbook/configuration/pdo_session_storage.html">documented in Symfony Cookbook documentation</a> for full documentation.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=powershell" style="background-image: url(../servlet/confluence/placeholder/macro-heading59dd.png?definition=e2NvZGU6bGFuZ3VhZ2U9cG93ZXJzaGVsbH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>framework:
    session:
        # ...
        handler_id: session.handler.pdo

parameters:
    pdo.db_options:
        db_table:    session
        db_id_col:   session_id
        db_data_col: session_value
        db_time_col: session_time

services:
    pdo:
        class: PDO
        arguments:
            dsn:      "mysql:dbname=&lt;mysql_database>"
            user:     &lt;mysql_user>
            password: &lt;mysql_password>

    session.handler.pdo:
        class:     Symfony\Component\HttpFoundation\Session\Storage\Handler\PdoSessionHandler
        arguments: ["@pdo", "%pdo.db_options%"]</pre></td></tr></table><h2>References</h2><ol><li><a href="http://symfony.com/doc/current/cookbook/session/index.html">Cookbook Session recipes (symfony.com)</a></li><li> <a href="http://symfony.com/doc/current/components/http_foundation/index.html">HTTP Fundation Component documentation (symfony.com)</a></li><li>Source code of <a href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Session/Storage/Handler/NativeFileSessionHandler.php">NativeFileSessionHandler (github.com)</a>, aka <code>session.handler.native_file</code> service</li><li><a href="http://symfony.com/doc/current/cookbook/configuration/pdo_session_storage.html">Cookbook Configuration recipe for setting-up PdoSessionHandler (symfony.com)</a>, aka <code>session.handler.pdo</code> service</li></ol><p> </p><p> </p><p> </p><p> </p>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=8323282 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 09:42:06 GMT -->
</html>
